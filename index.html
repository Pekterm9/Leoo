<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leoo</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial, sans-serif;}

body{
    background:#f5f6fa;
    display:flex;
    height:100vh;
}

.sidebar{
    width:230px;
    background:#111;
    color:white;
    padding:30px 20px;
    display:flex;
    flex-direction:column;
}

.sidebar h1{
    font-size:26px;
}

.sidebar p{
    font-size:13px;
    opacity:0.7;
    margin-bottom:40px;
}

.sidebar button{
    background:none;
    border:none;
    color:white;
    padding:12px;
    margin-bottom:10px;
    text-align:left;
    border-radius:8px;
    cursor:pointer;
    font-size:15px;
}

.sidebar button:hover{
    background:#222;
}

.sidebar button.active{
    border-left:4px solid #FFD700;
    background:#222;
}

.main{
    flex:1;
    padding:40px;
    overflow-y:auto;
}

.topbar{
    display:flex;
    justify-content:space-between;
    margin-bottom:30px;
}

.topbar button{
    background:#FFD700;
    border:none;
    padding:10px 18px;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
}

.list{
    display:flex;
    flex-direction:column;
    gap:12px;
}

.item{
    background:white;
    padding:15px;
    border-radius:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow:0 3px 6px rgba(0,0,0,0.08);
}

.item-left{
    display:flex;
    align-items:center;
    gap:12px;
}

.check{
    width:18px;
    height:18px;
    border:2px solid #333;
    cursor:pointer;
}

.warning{
    font-size:18px;
}

.date{
    font-size:14px;
    color:#555;
}

.modal-bg{
    position:fixed;
    inset:0;
    backdrop-filter:blur(6px);
    background:rgba(0,0,0,0.2);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:1000;
}

.modal{
    background:white;
    padding:30px;
    border-radius:12px;
    width:350px;
    display:flex;
    flex-direction:column;
    gap:15px;
}

.modal input{
    padding:10px;
    border-radius:6px;
    border:1px solid #ccc;
}

.modal button{
    background:#FFD700;
    border:none;
    padding:10px;
    border-radius:8px;
    font-weight:bold;
    cursor:pointer;
}

canvas{
    margin-top:20px;
}
</style>
</head>

<body>

<div class="sidebar">
    <h1>Leoo</h1>
    <p>think smarter, plan wiser</p>
    <button id="tasksBtn" class="active">Tasks</button>
    <button id="goalsBtn">Goals</button>
    <button id="statsBtn">Statistics</button>
</div>

<div class="main">
    <div class="topbar">
        <h2 id="workspaceTitle">Tasks</h2>
        <button id="newBtn">+ New</button>
    </div>
    <div id="content"></div>
</div>

<div class="modal-bg" id="modalBg">
    <div class="modal">
        <h3 id="modalTitle">New Task</h3>
        <input type="text" id="itemName" placeholder="Enter name">
        <input type="date" id="itemDate">
        <button id="createBtn">Create</button>
    </div>
</div>

<script>
let currentWorkspace = "tasks";
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let goals = JSON.parse(localStorage.getItem("goals")) || [];
let completedTasks = JSON.parse(localStorage.getItem("completedTasks")) || [];
let completedGoals = JSON.parse(localStorage.getItem("completedGoals")) || [];

const content = document.getElementById("content");
const modalBg = document.getElementById("modalBg");
const itemName = document.getElementById("itemName");
const itemDate = document.getElementById("itemDate");
const modalTitle = document.getElementById("modalTitle");

function save(){
    localStorage.setItem("tasks",JSON.stringify(tasks));
    localStorage.setItem("goals",JSON.stringify(goals));
    localStorage.setItem("completedTasks",JSON.stringify(completedTasks));
    localStorage.setItem("completedGoals",JSON.stringify(completedGoals));
}

function switchWorkspace(type){
    currentWorkspace = type;
    document.querySelectorAll(".sidebar button").forEach(b=>b.classList.remove("active"));
    document.getElementById(type+"Btn").classList.add("active");
    document.getElementById("workspaceTitle").innerText =
        type==="tasks" ? "Tasks" :
        type==="goals" ? "Goals" : "Statistics";

    if(type==="stats"){
        renderStats();
        document.getElementById("newBtn").style.display="none";
    }else{
        document.getElementById("newBtn").style.display="inline-block";
        renderList();
    }
}

function renderList(){
    content.innerHTML="";
    const list = document.createElement("div");
    list.className="list";

    const data = currentWorkspace==="tasks"?tasks:goals;

    data.forEach((item,index)=>{
        const div=document.createElement("div");
        div.className="item";

        const left=document.createElement("div");
        left.className="item-left";

        const check=document.createElement("div");
        check.className="check";
        check.dataset.index=index;

        const name=document.createElement("span");
        name.innerText=item.name;

        left.appendChild(check);
        left.appendChild(name);

        if(currentWorkspace==="tasks"){
            const right=document.createElement("div");

            const today=new Date();
            const due=new Date(item.date);
            const diff=Math.ceil((due-today)/(1000*60*60*24));

            let warning="";
            if(diff===1) warning="⚠";
            if(diff===0) warning="❗❗❗";

            right.innerHTML=`<span class="warning">${warning}</span> 
                             <span class="date">${diff>=0?diff+" days left":"Expired"}</span>`;

            div.appendChild(left);
            div.appendChild(right);
        }else{
            div.appendChild(left);
        }

        list.appendChild(div);
    });

    content.appendChild(list);
}

content.addEventListener("click",function(e){
    if(e.target.classList.contains("check")){
        const index=e.target.dataset.index;

        if(currentWorkspace==="tasks"){
            completedTasks.push({...tasks[index],completed:new Date()});
            tasks.splice(index,1);
        }else{
            completedGoals.push({...goals[index],completed:new Date()});
            goals.splice(index,1);
        }

        save();
        renderList();
    }
});

function renderStats(){
    content.innerHTML=`
        <canvas id="tasksChart"></canvas>
        <canvas id="goalsChart"></canvas>
    `;

    const months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    const taskData=new Array(12).fill(0);
    const goalData=new Array(12).fill(0);

    completedTasks.forEach(t=>{
        const m=new Date(t.completed).getMonth();
        taskData[m]++;
    });

    completedGoals.forEach(g=>{
        const m=new Date(g.completed).getMonth();
        goalData[m]++;
    });

    new Chart(document.getElementById("tasksChart"),{
        type:"bar",
        data:{
            labels:months,
            datasets:[{label:"Tasks Completed",data:taskData}]
        }
    });

    new Chart(document.getElementById("goalsChart"),{
        type:"bar",
        data:{
            labels:months,
            datasets:[{label:"Goals Completed",data:goalData}]
        }
    });
}

document.getElementById("newBtn").onclick=()=>{
    modalBg.style.display="flex";
    modalTitle.innerText=currentWorkspace==="tasks"?"New Task":"New Goal";
    itemDate.style.display=currentWorkspace==="tasks"?"block":"none";
};

modalBg.onclick=(e)=>{
    if(e.target===modalBg) modalBg.style.display="none";
};

document.getElementById("createBtn").onclick=()=>{
    if(!itemName.value) return;

    if(currentWorkspace==="tasks"){
        tasks.push({name:itemName.value,date:itemDate.value});
    }else{
        goals.push({name:itemName.value});
    }

    itemName.value="";
    itemDate.value="";
    modalBg.style.display="none";
    save();
    renderList();
};

document.getElementById("tasksBtn").onclick=()=>switchWorkspace("tasks");
document.getElementById("goalsBtn").onclick=()=>switchWorkspace("goals");
document.getElementById("statsBtn").onclick=()=>switchWorkspace("stats");

renderList();
</script>

</body>
</html>
